"use strict";var _graphqlYoga=require("graphql-yoga");var _index=_interopRequireDefault(require("./graphql/types/index"));var _uuidv=require("uuidv4");var _data=require("./data.json");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var pubsub=(0,_graphqlYoga.createPubSub)();// ! Resolvers
var resolvers={// ! Query
Query:{// ! Events
events:function events(){return _data.events},event:function event(parent,args){return _data.events.find(function(event){return event.id===parseInt(args.id)})},// ! Users
users:function users(){return _data.users},user:function user(parent,args){return _data.users.find(function(user){return user.id===parseInt(args.id)})},// ! Participants
participants:function participants(){return _data.participants},participant:function participant(parent,args){return _data.participants.find(function(participant){return participant.id===parseInt(args.id)})},// ! Locations
locations:function locations(){return _data.locations},location:function location(parent,args){return _data.locations.find(function(location){return location.id===parseInt(args.id)})}},// ! Event
Event:{// ! users
users:function users(parent,args){return _data.users.filter(function(user){return user.id===parseInt(parent.id)})},// ! participants
participants:function participants(parent,args){return _data.participants.filter(function(participant){return participant.id===parseInt(parent.id)})},// ! locations
locations:function locations(parent,args){return _data.locations.filter(function(location){return location.id===parseInt(parent.id)})}},// ! Mutation
Mutation:{// ! Event
createEvent:function createEvent(parent,_ref){var data=_ref.data;var event=_objectSpread({id:(0,_uuidv.uuid)()},data);_data.events.push(event);pubsub.publish("eventCreated",event);// ! Subscription
return event},updateEvent:function updateEvent(parent,_ref2){var id=_ref2.id,data=_ref2.data;var event_index=_data.events.findIndex(function(event){return event.id===parseInt(id)});if(event_index===-1){throw new Error("User not found")}var update_Event=_data.events[event_index]=_objectSpread(_objectSpread({},_data.events[event_index]),data);pubsub.publish("eventUpdated",update_Event);// ! Subscription
return update_Event},deleteEvent:function deleteEvent(parent,_ref3){var id=_ref3.id;var event_index=_data.events.findIndex(function(event){return event.id===parseInt(id)});if(event_index===-1){throw new Error("Event not Found")}var deletedEvent=_data.events[event_index];_data.events.splice(event_index,1);pubsub.publish("eventDeleted",deletedEvent);// ! Subscription
return deletedEvent},deleteAllEvents:function deleteAllEvents(){var length=_data.events.length;_data.events.splice(0,length);return{count:length}},// ! User
createUser:function createUser(parent,_ref4){var data=_ref4.data;var user=_objectSpread({id:(0,_uuidv.uuid)()},data);_data.users.push(user);pubsub.publish("userCreated",user);// ! Subscription
return user},updateUser:function updateUser(parent,_ref5){var id=_ref5.id,data=_ref5.data;var user_index=_data.users.findIndex(function(user){return user.id===parseInt(id)});if(user_index===-1){throw new Error("User not found")}var update_User=_data.users[user_index]=_objectSpread(_objectSpread({},_data.users[user_index]),data);pubsub.publish("userUpdated",update_User);// ! Subscription
return update_User},deleteUser:function deleteUser(parent,_ref6){var id=_ref6.id;var user_index=_data.users.findIndex(function(user){return user.id===parseInt(id)});if(user_index===-1){throw new Error("Event not Found")}var deletedUser=_data.users[user_index];_data.users.splice(user_index,1);pubsub.publish("userDeleted",deletedUser);// ! Subscription
return deletedUser},deleteAllUsers:function deleteAllUsers(){var length=_data.users.length;_data.users.splice(0,length);return{count:length}},// ! Participant
createParticipant:function createParticipant(parent,_ref7){var data=_ref7.data;var participant=_objectSpread({id:(0,_uuidv.uuid)()},data);_data.participants.push(participant);pubsub.publish("participantCreated",participant);// ! Subscription
return participant},updateParticipant:function updateParticipant(parent,_ref8){var id=_ref8.id,data=_ref8.data;var participant_index=_data.participants.findIndex(function(participant){return participant.id===parseInt(id)});if(participant_index===-1){throw new Error("User not found")}var update_Participant=_data.participants[participant_index]=_objectSpread(_objectSpread({},_data.participants[participant_index]),data);pubsub.publish("participantUpdated",update_Participant);// ! Subscription
return update_Participant},deleteParticipant:function deleteParticipant(parent,_ref9){var id=_ref9.id;var participant_index=_data.participants.findIndex(function(participant){return participant.id===parseInt(id)});if(participant_index===-1){throw new Error("Event not Found")}var deletedParticipant=_data.participants[participant_index];_data.participants.splice(participant_index,1);pubsub.publish("participantDeleted",deletedParticipant);// ! Subscription
return deletedParticipant},deleteAllParticipant:function deleteAllParticipant(){var length=_data.participants.length;_data.participants.splice(0,length);return{count:length}},// ! Location
createLocation:function createLocation(parent,_ref10){var data=_ref10.data;var location=_objectSpread({id:(0,_uuidv.uuid)()},data);_data.locations.push(location);pubsub.publish("locationCreated",location);// ! Subscription
return location},updateLocation:function updateLocation(parent,_ref11){var id=_ref11.id,data=_ref11.data;var location_index=_data.locations.findIndex(function(location){return location.id===parseInt(id)});if(location_index===-1){throw new Error("User not found")}var update_Location=_data.locations[location_index]=_objectSpread(_objectSpread({},_data.locations[location_index]),data);pubsub.publish("locationUpdated",update_Location);// ! Subscription
return update_Location},deleteLocation:function deleteLocation(parent,_ref12){var id=_ref12.id;var location_index=_data.locations.findIndex(function(location){return location.id===parseInt(id)});if(location_index===-1){throw new Error("Event not Found")}var deletedLocation=_data.locations[location_index];_data.locations.splice(location_index,1);pubsub.publish("locationDeleted",deletedLocation);// ! Subscription
return deletedLocation},deleteAllLocation:function deleteAllLocation(){var length=_data.locations.length;_data.locations.splice(0,length);return{count:length}}},// ! Subscription
Subscription:{// ! Event
eventCreated:{subscribe:function subscribe(){return pubsub.subscribe("eventCreated")},resolve:function resolve(payload){return payload}},eventUpdated:{subscribe:function subscribe(){return pubsub.subscribe("eventUpdated")},resolve:function resolve(payload){return payload}},eventDeleted:{subscribe:function subscribe(){return pubsub.subscribe("eventDeleted")},resolve:function resolve(payload){return payload}},// ! User
userCreated:{subscribe:function subscribe(){return pubsub.subscribe("userCreated")},resolve:function resolve(payload){return payload}},userUpdated:{subscribe:function subscribe(){return pubsub.subscribe("userUpdated")},resolve:function resolve(payload){return payload}},userDeleted:{subscribe:function subscribe(){return pubsub.subscribe("userDeleted")},resolve:function resolve(payload){return payload}},// ! Participant
participantCreated:{subscribe:function subscribe(){return pubsub.subscribe("participantCreated")},resolve:function resolve(payload){return payload}},participantUpdated:{subscribe:function subscribe(){return pubsub.subscribe("participantUpdated")},resolve:function resolve(payload){return payload}},participantDeleted:{subscribe:function subscribe(){return pubsub.subscribe("participantDeleted")},resolve:function resolve(payload){return payload}},// ! Location
locationCreated:{subscribe:function subscribe(){return pubsub.subscribe("locationCreated")},resolve:function resolve(payload){return payload}},locationUpdated:{subscribe:function subscribe(){return pubsub.subscribe("locationUpdated")},resolve:function resolve(payload){return payload}},locationDeleted:{subscribe:function subscribe(){return pubsub.subscribe("locationDeleted")},resolve:function resolve(payload){return payload}}}};var server=(0,_graphqlYoga.createServer)({schema:{typeDefs:_index["default"],resolvers:resolvers}});server.start();